<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Scan Pro | Ürün Analiz Dedektifi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .neon-glow {
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);
        }
        #reader__scan_region video {
            border-radius: 20px !important;
            object-fit: cover !important;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen flex flex-col items-center p-4 font-sans">

    <header class="w-full max-w-md text-center py-8">
        <h1 class="text-4xl font-extrabold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">
            SCAN PRO 2026
        </h1>
        <p class="text-slate-400 mt-2 text-sm tracking-widest uppercase">Global Ürün & Orijinallik Analizi</p>
    </header>

    <main class="w-full max-w-md space-y-6">
        
        <div class="relative">
            <div id="reader" class="glass rounded-3xl overflow-hidden neon-glow"></div>
            <div class="absolute inset-0 pointer-events-none border-2 border-cyan-500/30 rounded-3xl"></div>
        </div>

        <div id="result-card" class="glass rounded-3xl p-6 hidden animate-bounce-in">
            <div class="flex items-center justify-between mb-4">
                <span id="status-badge" class="px-3 py-1 bg-green-500/20 text-green-400 text-xs rounded-full border border-green-500/30 font-bold uppercase">
                    Orijinal Kayıt
                </span>
                <button onclick="resetScanner()" class="text-slate-400 text-sm hover:text-white">✕ Kapat</button>
            </div>

            <h2 id="product-title" class="text-2xl font-bold text-white mb-1">Ürün Adı</h2>
            <p id="product-brand" class="text-cyan-400 font-medium mb-4 italic">Marka Bilgisi</p>

            <div class="space-y-3 text-sm border-t border-white/10 pt-4">
                <div class="flex justify-between">
                    <span class="text-slate-400 text-xs uppercase tracking-tighter">Ülke / Menşei</span>
                    <span id="product-origin" class="font-semibold text-xs uppercase tracking-tighter">—</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-slate-400 text-xs uppercase tracking-tighter">Kategori</span>
                    <span id="product-category" class="font-semibold text-xs uppercase tracking-tighter">—</span>
                </div>
                <div class="mt-4">
                    <span class="text-slate-400 text-xs uppercase tracking-tighter block mb-1">İçerik Analizi</span>
                    <div id="product-ingredients" class="p-3 bg-black/30 rounded-xl text-xs leading-relaxed text-slate-300">
                        Bilgi aranıyor...
                    </div>
                </div>
            </div>
        </div>

        <div id="info-msg" class="text-center text-slate-500 text-xs px-10 leading-relaxed">
            Kamerayı barkoda veya QR koda yaklaştırın. <br> Sistem otomatik olarak global veritabanında sorgulama yapacaktır.
        </div>

    </main>

    <script>
        const html5QrCode = new Html5Qrcode("reader");
        const resultCard = document.getElementById('result-card');
        const infoMsg = document.getElementById('info-msg');

        const qrConfig = { fps: 10, qrbox: { width: 250, height: 250 } };

        // Tarama Başlatma
        html5QrCode.start({ facingMode: "environment" }, qrConfig, onScanSuccess);

        function onScanSuccess(decodedText) {
            // Barkodu okuyunca sesi veya titreşimi tetikleyebiliriz
            if (navigator.vibrate) navigator.vibrate(100);
            
            // Veri Çekme (Open Food Facts API - Global & Ücretsiz)
            fetch(`https://world.openfoodfacts.org/api/v2/product/${decodedText}.json`)
                .then(res => res.json())
                .then(data => {
                    if (data.status === 1) {
                        showProduct(data.product);
                    } else {
                        alert("Ürün bulundu ancak detayları global veritabanında henüz tanımlanmamış: " + decodedText);
                    }
                })
                .catch(err => console.error("API Hatası:", err));
        }

        function showProduct(p) {
            document.getElementById('product-title').innerText = p.product_name || "Bilinmeyen Ürün";
            document.getElementById('product-brand').innerText = p.brands || "Markasız";
            document.getElementById('product-origin').innerText = p.countries || "Bilinmiyor";
            document.getElementById('product-category').innerText = p.categories_tags ? p.categories_tags[0].replace('en:', '') : "Genel";
            document.getElementById('product-ingredients').innerText = p.ingredients_text_tr || p.ingredients_text_en || "İçerik bilgisi mevcut değil.";

            resultCard.classList.remove('hidden');
            infoMsg.classList.add('hidden');
        }

        function resetScanner() {
            resultCard.classList.add('hidden');
            infoMsg.classList.remove('hidden');
        }
    </script>
</body>
</html>
